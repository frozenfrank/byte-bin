#!/bin/zsh

# Take in a directory from the commandline
DIR=${1:-$PWD}

# Verify that the directory exists
if [ -d "$DIR" ]; then
    echo "Calculating size of all node_modules/ directories within $DIR"
    cd $DIR
else
    echo "Error: Directory $DIR does not exist."
    exit 1
fi

# Run the pipeline command
find **/node_modules -type d | \
grep -E "node_modules$" | \
grep -vE "node_modules/" | \
xargs du -hs | \
sort -hr
